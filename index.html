<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Color Palette Studio</title>
  <meta name="description" content="Extract colors from images, build palettes, check contrast, and save palettes locally.">

  <!-- Tailwind CDN (required) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- jQuery CDN (required, must be before local scripts) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

  <link rel="stylesheet" href="styles/main.css">

  <!-- Tailwind component layer for custom utility classes; kept inline per rules -->
  <style type="text/tailwindcss" data-teda="tailwind-apply">
    @layer components {
      .btn-primary { @apply bg-indigo-600 text-white px-4 py-2 rounded-md shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300; }
      .btn-ghost { @apply bg-white border border-gray-200 px-3 py-1.5 rounded-md text-sm text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-100; }
      .chip { @apply inline-flex items-center justify-center px-3 py-1 rounded-md text-sm font-medium; }
      .glass { @apply bg-white/60 backdrop-blur-sm border border-white/20; }
      .swatch { @apply w-20 h-20 rounded-md shadow-sm border border-white/10; }
      .save-btn { @apply bg-emerald-600 text-white px-3 py-1.5 rounded-md shadow-sm hover:bg-emerald-700; }
      .danger-btn { @apply bg-red-600 text-white px-3 py-1.5 rounded-md hover:bg-red-700; }
    }
  </style>

</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">
  <header class="p-4 sm:p-6 lg:p-8 border-b border-gray-200 bg-gradient-to-r from-white to-white/95">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-lg bg-gradient-to-br from-indigo-500 to-emerald-400 flex items-center justify-center shadow-lg">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden>
            <path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" fill="white"></path>
          </svg>
        </div>
        <div>
          <h1 class="text-lg font-semibold">Color Palette Studio</h1>
          <p class="text-sm text-gray-500">Extract palettes, test contrast, and save your favorite sets.</p>
        </div>
      </div>
      <nav class="hidden sm:flex items-center gap-3">
        <button class="btn-ghost" id="helpBtn" aria-haspopup="dialog">Help</button>
        <a class="btn-primary" href="#saved" id="focusSaved">Saved Palettes</a>
      </nav>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Left: Image input and controls -->
    <section class="glass p-4 sm:p-6 rounded-lg shadow-sm" aria-labelledby="image-tools">
      <h2 id="image-tools" class="text-md font-semibold mb-3">Image & Input</h2>

      <div class="space-y-3">
        <label class="block text-sm font-medium">Upload an image</label>
        <div class="flex items-center gap-3">
          <input aria-label="Upload image" id="imageInput" type="file" accept="image/*" class="hidden">
          <button id="chooseFile" class="btn-primary" aria-controls="imageInput">Choose file</button>
          <button id="useSample" class="btn-ghost">Use sample</button>
          <button id="clearImage" class="danger-btn">Clear</button>
        </div>

        <label class="block text-sm font-medium">Or paste image URL</label>
        <div class="flex gap-2">
          <input id="imageUrl" type="url" placeholder="https://example.com/photo.jpg" class="w-full px-3 py-2 rounded-md border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-100" aria-label="Image URL">
          <button id="loadUrl" class="btn-primary">Load</button>
        </div>

        <div class="pt-3">
          <canvas id="hiddenCanvas" width="400" height="300" class="hidden" aria-hidden="true"></canvas>
          <div id="previewWrap" class="rounded-md border border-gray-200 overflow-hidden bg-white/40">
            <img id="previewImage" src="" alt="Preview" class="w-full h-52 object-cover" style="display:none;"/>
            <div id="previewEmpty" class="p-6 text-center text-sm text-gray-500">No image loaded. Use upload, URL, or sample.</div>
          </div>
        </div>

        <div class="flex items-center justify-between mt-4">
          <div class="flex items-center gap-2">
            <label class="text-sm">Colors to extract</label>
            <select id="numColors" class="px-2 py-1 rounded-md border border-gray-200 focus:ring-2 focus:ring-indigo-100">
              <option value="4">4</option>
              <option value="6" selected>6</option>
              <option value="8">8</option>
            </select>
          </div>
          <div>
            <button id="extractBtn" class="btn-primary">Extract Colors</button>
          </div>
        </div>

        <div id="progress" class="mt-3 text-sm text-gray-500" aria-live="polite"></div>
      </div>

    </section>

    <!-- Middle: Extracted palette and interactions -->
    <section class="glass p-4 sm:p-6 rounded-lg shadow-sm lg:col-span-2" aria-labelledby="extracted">
      <div class="flex items-start justify-between">
        <h2 id="extracted" class="text-md font-semibold">Extracted Colors</h2>
        <div class="flex items-center gap-2">
          <button id="copyPalette" class="btn-ghost" title="Copy palette JSON">Copy JSON</button>
          <button id="clearSwatches" class="btn-ghost">Clear</button>
          <button id="savePalette" class="save-btn">Save Palette</button>
        </div>
      </div>

      <p class="text-sm text-gray-500 mt-2">Click any swatch to add it to the active palette. Use the checkboxes to measure contrast between two colors.</p>

      <div id="swatchGrid" class="mt-4 grid grid-cols-3 sm:grid-cols-6 gap-4" aria-live="polite" aria-relevant="additions removals">
        <!-- swatches appear here -->
      </div>

      <div class="mt-6">
        <h3 class="text-sm font-medium">Active Palette</h3>
        <div id="activePalette" class="mt-3 flex flex-wrap gap-3 items-center">
          <!-- active palette chips -->
        </div>
        <div class="mt-3 text-sm text-gray-500">Max 8 colors. Click a chip to remove it.</div>
      </div>

      <div class="mt-6">
        <h3 class="text-sm font-medium">Contrast Tester</h3>
        <p class="text-xs text-gray-500">Select two colors to compute contrast ratio and WCAG pass levels.</p>
        <div id="contrastPanel" class="mt-3 flex flex-col sm:flex-row gap-3 items-start sm:items-center">
          <div class="flex gap-2 items-center">
            <div class="w-12 h-12 rounded-md border border-gray-200" id="contrastA" aria-hidden></div>
            <div id="contrastALabel" class="text-sm">A</div>
          </div>
          <div class="flex gap-2 items-center">
            <div class="w-12 h-12 rounded-md border border-gray-200" id="contrastB" aria-hidden></div>
            <div id="contrastBLabel" class="text-sm">B</div>
          </div>
          <div class="ml-0 sm:ml-6">
            <div id="contrastResult" class="text-sm font-medium">Select two colors to see ratio</div>
            <div id="contrastDetails" class="text-xs text-gray-500 mt-1">&nbsp;</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Right column: Saved palettes and history -->
    <aside id="saved" class="glass p-4 sm:p-6 rounded-lg shadow-sm" aria-labelledby="savedHeading">
      <h2 id="savedHeading" class="text-md font-semibold">Saved Palettes</h2>
      <p class="text-sm text-gray-500 mt-1">Your palettes are stored locally in your browser.</p>

      <div class="mt-4 flex items-center gap-2">
        <input id="paletteName" type="text" placeholder="Palette name" class="flex-1 px-3 py-2 rounded-md border border-gray-200 focus:ring-2 focus:ring-indigo-100" aria-label="Palette name">
        <button id="quickSave" class="save-btn">Quick Save</button>
      </div>

      <div id="savedList" class="mt-4 space-y-3 max-h-72 overflow-auto pr-2">
        <!-- saved palettes rendered here -->
      </div>

      <div class="mt-4 border-t pt-3">
        <button id="exportAll" class="btn-ghost">Export all</button>
        <button id="importAll" class="btn-ghost">Import</button>
      </div>

    </aside>
  </main>

  <!-- Help dialog (simple modal) -->
  <div id="helpModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center p-4" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="bg-white rounded-lg shadow-lg max-w-lg w-full p-6">
      <h3 id="helpTitle" class="text-lg font-semibold">How to use</h3>
      <div class="mt-3 text-sm text-gray-700 space-y-2">
        <p>Load an image via upload or URL, then click Extract Colors. Click swatches to add them to your active palette. Save palettes for later use. Use the contrast panel to compare two colors for accessibility.</p>
        <p>Palettes are saved to your browser local storage and persist across reloads.</p>
        <p>Built by <a class="text-indigo-600 underline" href="https://teda.dev" target="_blank" rel="noreferrer">Teda.dev</a> â€” the simplest AI app builder for regular people.</p>
      </div>
      <div class="mt-4 text-right">
        <button id="closeHelp" class="btn-primary">Close</button>
      </div>
    </div>
  </div>

  <!-- Scripts must load in specific order: jQuery already loaded above -->
  <script src="scripts/helpers.js"></script>
  <script src="scripts/ui.js"></script>
  <script src="scripts/main.js"></script>
</body>
</html>
